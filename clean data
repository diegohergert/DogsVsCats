import os
from PIL import Image

# --- CONFIGURE THIS ---
# Point this to the folders you want to clean
folders_to_clean = [
    "all_cats_merged",
    "all_dogs_merged"
]
# ----------------------

def clean_folder(folder_path):
    print(f"\nScanning folder: {folder_path}...")
    corrupt_files = []
    
    if not os.path.exists(folder_path):
        print(f"Error: Folder not found: {folder_path}")
        return

    for filename in os.listdir(folder_path):
        if not (filename.endswith('.jpg') or filename.endswith('.jpeg')):
            continue  # Skip non-JPEG files

        filepath = os.path.join(folder_path, filename)
        
        try:
            # Open the image and run verify()
            with Image.open(filepath) as img:
                img.verify() # This checks for corruption
                
        except Exception as e:
            # If verify() fails, the file is corrupt
            print(f"  - Found corrupt file: {filename} (Error: {e})")
            corrupt_files.append(filepath)

    print(f"Scan complete. Found {len(corrupt_files)} corrupt files.")
    
    # --- Deletion Step ---
    if corrupt_files:
        # Ask user for confirmation
        choice = input("Do you want to DELETE all these corrupt files? (yes/no): ")
        if choice.lower() == 'yes':
            for f in corrupt_files:
                try:
                    os.remove(f)
                    print(f"    Deleted: {f}")
                except Exception as e:
                    print(f"    Error deleting {f}: {e}")
            print("Deletion complete.")
        else:
            print("No files were deleted.")

# --- Run the cleaner ---
if __name__ == "__main__":
    for folder in folders_to_clean:
        clean_folder(folder)